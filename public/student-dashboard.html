<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - Global Pathway</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <div class="glass-panel" style="max-width: 1000px; width: 90%; margin: 50px auto; padding: 40px; min-height: 80vh;">

        <!-- Header -->
        <div
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 20px;">
            <div class="logo" style="font-size: 24px;">
                <i class="fas fa-globe-americas" style="color: var(--primary-color);"></i>
                Global Pathway
            </div>
            <div style="display: flex; align-items: center; gap: 20px;">
                <span style="font-size: 14px; color: var(--text-medium);">Welcome, Student</span>
                <button onclick="logout()" class="btn-secondary"
                    style="background: rgba(255,255,255,0.5); color: var(--text-dark); width: auto; padding: 8px 20px; border-radius: 20px; font-size: 14px;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>

        <!-- 1. Selection Phase -->
        <div id="selection-phase">
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 32px; font-weight: 300; margin-bottom: 10px;">Your Journey Starts Here</h2>
                <p style="color: var(--text-medium);">Choose your path to global opportunities</p>
            </div>

            <div class="dashboard-grid">
                <!-- Feature Card: Study Abroad -->
                <div class="feature-card" onclick="showForm('Study')">
                    <div class="feature-icon"><i class="fas fa-graduation-cap"></i></div>
                    <h3>Study Abroad</h3>
                    <p>Apply for top-tier universities worldwide. Unlock your academic potential.</p>
                </div>

                <!-- Feature Card: Work Abroad -->
                <div class="feature-card" onclick="showForm('Work')">
                    <div class="feature-icon"><i class="fas fa-briefcase"></i></div>
                    <h3>Work Abroad</h3>
                    <p>Explore international career opportunities and expand your professional horizon.</p>
                </div>
            </div>

            <div style="margin: 60px 0 40px; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 40px;">
                <h3 style="text-align: center; margin-bottom: 20px;">Track Application Status</h3>
                <div class="input-group">
                    <input type="text" id="trackAppId" class="modern-input"
                        placeholder="Enter Application ID (e.g., APP-123456)">
                    <button onclick="trackApplication()" class="input-btn">Track</button>
                </div>
                <div id="trackResult" style="margin-top: 20px; text-align: center; font-weight: 500;"></div>
            </div>

            <div style="margin-top: 50px;">
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-folder-open" style="color: var(--primary-color);"></i> My Applications
                </h3>
                <div id="my-applications-list" class="glass-container"
                    style="background: rgba(255,255,255,0.4); border-radius: 12px; padding: 20px; max-height: 300px; overflow-y: auto;">
                    <!-- List populated by JS -->
                    <p style="text-align: center; color: var(--text-light); padding: 20px;">Loading applications...</p>
                </div>
            </div>
        </div>

        <!-- 2. Application Form -->
        <div id="application-form-container" class="hidden">
            <button onclick="showSelection()"
                style="background: transparent; color: var(--text-medium); width: auto; margin-bottom: 20px; padding: 0; display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-arrow-left"></i> Back to Dashboard
            </button>

            <div class="glass-card" style="max-width: 600px; margin: 0 auto; text-align: left;">
                <h2 id="form-title"
                    style="margin-bottom: 20px; color: var(--primary-color); border-bottom: 1px solid rgba(0,0,0,0.05); padding-bottom: 10px;">
                    Application</h2>

                <form id="appForm">
                    <input type="hidden" id="appType">

                    <div class="form-group">
                        <label><i class="fas fa-user" style="width: 20px; color: var(--primary-color);"></i> Full
                            Name</label>
                        <input type="text" id="fullName" required placeholder="John Doe">
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-phone" style="width: 20px; color: var(--primary-color);"></i> Contact
                            Number</label>
                        <input type="text" id="contactNumber" required placeholder="+1 234 567 890">
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-envelope" style="width: 20px; color: var(--primary-color);"></i>
                            Email</label>
                        <input type="email" id="appEmail" required placeholder="john@example.com">
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-globe" style="width: 20px; color: var(--primary-color);"></i> Country of
                            Interest</label>
                        <select id="country" required>
                            <option value="">Select Country...</option>
                            <option value="USA">USA</option>
                            <option value="UK">UK</option>
                            <option value="Canada">Canada</option>
                            <option value="Australia">Australia</option>
                            <option value="Germany">Germany</option>
                            <option value="France">France</option>
                            <option value="Ireland">Ireland</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label id="courseOrJobLabel"><i class="fas fa-book"
                                style="width: 20px; color: var(--primary-color);"></i> Course Interested</label>

                        <!-- Course Dropdown -->
                        <select id="courseSelect">
                            <option value="">Select Course...</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Data Science">Data Science</option>
                            <option value="Business Administration">Business Administration</option>
                            <option value="Engineering">Engineering</option>
                            <option value="Medicine">Medicine</option>
                            <option value="Law">Law</option>
                            <option value="Arts & Humanities">Arts & Humanities</option>
                        </select>

                        <!-- Job Input (Hidden by default) -->
                        <input type="text" id="jobInput" class="hidden" placeholder="e.g. Software Engineer">
                    </div>

                    <button type="submit" class="hero-btn" style="width: 100%; margin-top: 20px;">
                        Submit Application <i class="fas fa-paper-plane" style="margin-left: 8px;"></i>
                    </button>
                </form>
            </div>
        </div>

    </div>

    <script src="js/app.js"></script>
    <script>
        // Check Auth using token existence as simple check
        if (!localStorage.getItem('token')) {
            window.location.href = 'index.html';
        } else {
            loadMyApplications();
            // Pre-fill email if possible
            // const user = JSON.parse(localStorage.getItem('user'));
            // if(user && user.username) document.querySelector('.welcome-text').innerText = `Welcome, ${user.username}`;
        }

        function showForm(type) {
            document.getElementById('selection-phase').classList.add('hidden');
            document.getElementById('application-form-container').classList.remove('hidden');
            document.getElementById('form-title').innerText = type + ' Abroad Application';
            document.getElementById('appType').value = type;

            if (type === 'Study') {
                document.getElementById('courseOrJobLabel').innerHTML = '<i class="fas fa-book" style="width: 20px; color: var(--primary-color);"></i> Course Interested';
                document.getElementById('courseSelect').classList.remove('hidden');
                document.getElementById('courseSelect').required = true;

                document.getElementById('jobInput').classList.add('hidden');
                document.getElementById('jobInput').required = false;
            } else {
                document.getElementById('courseOrJobLabel').innerHTML = '<i class="fas fa-briefcase" style="width: 20px; color: var(--primary-color);"></i> Job Title / Position';
                document.getElementById('courseSelect').classList.add('hidden');
                document.getElementById('courseSelect').required = false;

                document.getElementById('jobInput').classList.remove('hidden');
                document.getElementById('jobInput').required = true;
            }
        }

        function showSelection() {
            document.getElementById('selection-phase').classList.remove('hidden');
            document.getElementById('application-form-container').classList.add('hidden');
        }
    </script>
</body>

</html>